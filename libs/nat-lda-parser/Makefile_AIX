OBJ = startldaparser.o printLDA.o free.o

INCLUDE = -I../varhandle_lib/src/

LIBS = -L../varhandle_lib/ -lvars

CFLAGS = -c -g -DLOGDEBUG

CC = xlc

lib: clean $(OBJ)
	@printf "Linking libldaparser.a\n"
	@ar -vcru libldaparser.a ./bin/*.o

lib_debug:
	make -f Makefile_AIX clean
	xlc $(CFLAGS) -g -DLOGDEBUG ./src/start.c $(INCLUDE) -o ./bin/start.o
	xlc $(CFLAGS) -g -DLOGDEBUG ./src/printLDA.c $(INCLUDE) -o ./bin/printLDA.o
	xlc $(CFLAGS) -g -DLOGDEBUG ./src/free.c $(INCLUDE) -o ./bin/free.o
	ar -vcru libldaparser.a ./bin/*.o

	
$(OBJ):
	@printf "CC ./src/$*.c => ./bin/$*.o\n"
	@$(CC) $(CFLAGS) ./src/$*.c $(INCLUDE) -o ./bin/$*.o

clean:
	@printf "Clean libldaparser.a"
	@rm -rf libldaparser.a
	@printf "Cleaning Objects\n"
	@rm -rf ./bin/*.o

test:
	xlc -g ./test_src/main.c $(INCLUDE) -o ./test_src/test -L./ -lldaparser -I./src/ $(LIBS)
	./test_src/test ./test_files/PTRLTEST.NGL
