CC = xlc

INCLUDE = -I./include \
		  -I../../include/ \
		  -I../varhandle_lib/src/ \
		  -I../rh4n_logging/include/

LIBS = -L../rh4n_logging -lrh4nlogging \
	   -L./ -lrh4nldaparser


CFLAGS_LIB = -c -g $(INCLUDE)
CFLAGS_BIN = -g $(INCLUDE)

LIB_LDA_OBJS = rh4n_ldaparser.o \
			   rh4n_lda_filehandling.o \
			   rh4n_lda_array.o \
			   rh4n_lda_utils.o \
			   rh4n_lda_variables.o \
			   rh4n_lda_print.o \
			   rh4n_lda_free.o

lib: clean $(LIB_LDA_OBJS)
	@printf "Linking librh4nldaparser.a\n"
	@ar -cru librh4nldaparser.a ./bin/*.o

$(LIB_LDA_OBJS):
	@printf "CC ./src/$*.c => ./bin/$*.o\n"
	@$(CC) $(CFLAGS_LIB) -o ./bin/$*.o ./src/$*.c

test: lib
	@printf "CC ./test/main.c => ./test/main\n"
	@$(CC) $(CFLAGS_BIN) -o ./test/main ./test/main.c $(LIBS)
	@rm -f ./logs/rh4n_LDALIB_LDAPARSE_`date +%d.%m.%Y`.log
	@./test/main
	@cat ./logs/rh4n_LDALIB_LDAPARSE_`date +%d.%m.%Y`.log


clean:
	@printf "Cleaning librh4nldaparser.a\n"
	@rm -rf "librh4nldaparser.a\n"
	@printf "Cleaning LDA parser objects\n"
	@rm -rf ./bin/*.o
