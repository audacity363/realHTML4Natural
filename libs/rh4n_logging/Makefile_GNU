CC = gcc
CFLAGS = -g -c -Wall

INCLUDES = -I./include/

OBJS = rh4n_logging.o

all: lib
	@printf "Done.\n"

lib: clean $(OBJS)
	@printf "Packing static library\n"
	@ar -vcru librh4nlogging.a ./bin/*.o

$(OBJS):
	@printf "CC ./src/$*.c => ./bin/$*.o\n"
	@$(CC) $(CFLAGS) $(INCLUDES) -o ./bin/$*.o ./src/$*.c

maintest: lib
	@printf "CC ./test/main.c => ./test/main\n"
	@$(CC) -g $(INCLUDES) -o ./tests/main ./tests/main.c -L./ -lrh4nlogging
	@printf "Running maintest\n"
	@./tests/main

clean:
	@printf "Cleaning logging static library\n"
	@rm -rf ./librh4nlogging.a
	@printf "Cleaning logging objects\n"
	@rm -rf ./bin/*.o
	@printf "Cleaning tests\n"
	@rm -rf ./tests/main
